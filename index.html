<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>Chris Gregori</title>
    <meta name="description" content="">
  
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway:300,400|Lato" rel="stylesheet">
  
    <script  src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script  src="js/scripts.js" type="text/javascript"></script>
  </head>

  <body>
    <div class="container full-height">
      <div class="row full-size-row">
        <div class="side-bar three columns">
          <div>
            <div class="blurb">
              <div class="image">
                <img src="images/avatar.png" />
              </div>
              <div class="details">
                <h1>Chris Gregori</h1>
                <h2>Full-Stack Software Engineer</h2>
                <h3>
                  <div class="type-wrap">
                    <div id="typed-strings"></div>
                    <span id="typed" style="white-space:pre;"></span>
                  </div>
                </h3>
              </div>
            </div>
            <div class="links">
              <ul>
                <li><a href="index.html">Projects</a></li>
                <li><a href="experience.html">Experience</a></li>
                <li><a href="education.html">Education</a></li>
                <li><a href="photography.html">Photography</a></li>
                <li><a href=https://medium.com/@chrisgregori/>Blog</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="eight columns content">
          <div id="projects" class="primary-content projects nine columns">
          
          	<h1>Projects, Apps & Code</h1>
            <div>
              <h2 class="github-projects-title">Github Projects</h2>
              <ul class="github-projects">
              </ul>
            </div>
          
          </div>
          
          
          <script>
            var githubProjects = document.querySelector('.github-projects');
            if (typeof(githubProjects) != 'undefined' && githubProjects != null){
              populateGithubProjects();
            }
          
            function populateGithubProjects() {
              const root = 'https://api.github.com';
          
              fetch(root + '/users/chrisgreg/repos')
                .then(getRepos)
                .then(renderRepos)
          			.then(renderMetaData);
          
              function getRepos(response) {
                return response.json().then((json) => {
                  var repos = formatRepos(json);
                  return repos;
                })
              }
          
              function renderRepos(repos) {
                for(var i = 0; i < repos.length; ++i) {
                  var element = document.createElement('li');
                  element.innerHTML = '<div class="github-project"><h4 class="title"><span>'
          															+ repos[i].name + '</span></h4><div class="description">'
          															+ repos[i].description + '</div><div class="stats"><div class="language">'+ repos[i].language+'</div><div class="stars">'+ repos[i].stars + ' stars</div><div class="url"><a href="'+ repos[i].url +'">Repository Link</a></div></div></div>';
                  githubProjects.appendChild(element);
                }
          			return repos;
              }
          
          		function renderMetaData(repos) {
          			var githubProjectsTitle = document.querySelector('.github-projects-title');
          			githubProjectsTitle.innerHTML = githubProjectsTitle.innerHTML + ' - ' + repos.length + ' projects';
          
          		}
          
              function formatRepos(json) {
                return json.map(repo => {
                  return {
                    id: repo.id,
                    created_date: repo.created_at,
                    url: repo.html_url,
                    description: repo.description || 'No description available',
                    name: repo.name,
                    stars: repo.stargazers_count,
                    watchers: repo.watchers,
          					language: repo.language
                  }
                }).sort((a,b) => {
                  return new Date(b.created_date) - new Date(a.created_date);
                })
              }
            }
          </script>
        </div>
      </div>


    </div>
  </body>

</html>
